# MoeTrip

萌旅网 - 旅游景区信息管理系统

## 项目简介

MoeTrip 是一个旅游景区信息管理系统，采用前后端分离架构，基于 Vue3、Node.js 和 PostgreSQL / MySQL 开发，使用 TypeScript 确保代码质量。系统提供景区资源管理、用户信息管理、票务预约和数据分析功能，界面简洁直观，支持游客查询、购票及管理者运营分析。

图一乐的毕设作品，基本所有工作都由 cursor 完成。

## 技术栈

- **前端**:
  - 框架：Vue3
  - 语言：TypeScript
  - HTTP 请求：Fetch
  - UI 组件库：Vuetify 3
  - 数据可视化：ECharts
- **后端**:
  - 运行环境：Node.js
  - 框架：Express
  - 语言：TypeScript
  - ORM：Sequelize
- **数据库**：PostgreSQL / MySQL
- **工具**:
  - 版本控制：Git
  - API 测试：Apifox
  - 测试框架：Jest

## 功能模块

- **景区资源管理**:
  - 管理景点信息（名称、介绍、开放时间、图片）
  - 管理设施信息（位置、状态、维护记录）
  - 支持增删改查和搜索
- **用户信息管理**:
  - 用户注册、登录（游客、管理者角色）
  - 角色权限管理
  - 记录浏览、预定、反馈行为
- **票务与预约**:
  - 在线购票、退票、改签
  - 管理门票类型和价格
  - 预约冲突检测。
- **数据分析与可视化**:
  - 统计游客流量和商品销售
  - 生成收入和满意度报表
  - 支持动态图表展示

## 功能完成状态

### 已完成功能

- [x] **用户管理系统**
  - [x] 用户注册功能
  - [x] 用户登录功能
  - [x] 用户权限区分（用户/管理员）
  - [x] JWT身份认证
  - [x] 用户信息管理
  
- [x] **景区资源管理**
  - [x] 景点信息的增删改查
  - [x] 景点列表展示和分页
  - [x] 景点详情页面
  - [x] 景点搜索功能
  - [x] 景点开放时间管理
  
- [x] **设施管理**
  - [x] 设施信息的增删改查
  - [x] 按景点筛选设施
  - [x] 设施状态管理
  - [x] 设施位置定位
  
- [x] **票务与预约系统**
  - [x] 票种管理
  - [x] 票种余量查询
  - [x] 订单创建
  - [x] 订单查询
  - [x] 票价系统实现
  - [x] 退票与改签功能
  - [x] 预约冲突检测

- [x] **反馈系统**
  - [x] 用户评分和评论
  - [x] 反馈列表查询
  - [x] 反馈统计分析
  - [x] 评分分布展示

- [x] **数据分析与可视化系统（基础）**
  - [x] 管理员统计API（用户数量、景点数量、反馈数量、平均评分）
  - [x] 景点统计API（热门景点排名）
  - [x] 反馈统计API（评分分布、评论占比）
  - [x] 管理面板数据可视化展示

- [x] **前端界面**
  - [x] 响应式设计
  - [x] 基于Vuetify的Material Design风格
  - [x] 用户友好的表单和列表
  - [x] 简洁直观的操作流程

### 待完成功能

- [ ] **游客行为记录系统**
  - [ ] 浏览历史记录
  - [ ] 预定记录追踪
  - [ ] 评价反馈管理
  - [ ] 用户行为分析

- [ ] **图片和媒体管理系统**
  - [ ] 景区和设施图片上传
  - [ ] 图片存储和管理功能
  - [ ] 图片展示和轮播
  - [ ] 媒体资源优化

- [ ] **数据分析与可视化系统**
  - [ ] 游客流量统计
  - [ ] 商品销售分析
  - [ ] 景区收入数据报表
  - [ ] 景区满意度分析报表
  - [ ] 数据导出功能

### 近期开发计划

根据任务书要求，我们将按照以下优先级进行开发：

1. **完善游客行为记录功能**
   - [ ] 实现游客浏览历史记录
   - [ ] 完善用户预订记录管理
   - [ ] 优化评价反馈系统
   - [ ] 添加用户行为数据分析

2. **实现数据分析与可视化功能（核心任务）**
   - [ ] 游客流量时间分布分析
   - [ ] 订单和销售趋势分析
   - [ ] 景区收入数据报表系统
   - [ ] 满意度深度分析工具
   - [ ] 高级数据筛选与导出

3. **图片上传和媒体管理功能**
   - [ ] 实现景点图片上传
   - [ ] 添加设施图片管理
   - [ ] 优化图片展示效果
   - [ ] 完善媒体资源管理

## 系统测试计划

为满足任务书要求，我们将采用实际或模拟数据进行系统测试：

1. **功能测试**
   - 使用模拟数据测试所有功能模块
   - 验证各个功能点的正确性和完整性

2. **性能测试**
   - 测试系统在高并发情况下的性能
   - 评估数据库查询效率和响应时间

3. **用户体验测试**
   - 邀请实际用户进行操作测试
   - 收集用户反馈并优化界面和流程

4. **安全性测试**
   - 进行权限和认证机制测试
   - 验证数据保护措施的有效性

## 远期规划

### 第一阶段（近期优化）

1. **票价系统集成**
   - 建立完整的票价模型
   - 支持多种票价策略（节假日定价、早鸟票等）
   - 提供价格管理界面

2. **图片与多媒体管理**
   - 实现图片和视频上传功能
   - 支持图片预览和编辑
   - 管理多媒体资源库

3. **退票与改签流程**
   - 完善退票和改签业务逻辑
   - 自动处理票务余量变更
   - 提供灵活的规则配置

4. **数据分析平台进阶**
   - 拓展已有统计API功能
   - 实现更多高级数据分析
   - 添加数据挖掘和预测分析
   - 支持报表定制与导出

5. **安全性强化**
   - 升级密码加密算法（从SHA1到bcrypt）
   - 实现CSRF保护和请求频率限制
   - 数据脱敏和隐私保护
   - 完善权限控制系统
   - HTTPS支持：通过环境变量配置，确保API通信安全
     - 设置`USE_HTTPS=true`启用HTTPS
     - 配置SSL证书路径（`SSL_CERT_PATH`、`SSL_KEY_PATH`）

6. **测试体系优化**
   - 提高单元测试覆盖率
   - 添加集成测试和端到端测试
   - 实现测试自动化流程
   - 建立持续集成环境

7. **错误处理机制**
   - 标准化错误响应
   - 完善全局错误拦截
   - 优化前端错误提示
   - 实现错误日志收集和分析

### 第二阶段（功能拓展）

1. **多语言支持**
   - 添加国际化框架
   - 支持英文界面
   - 支持多语言切换

2. **移动端适配**
   - 开发移动端应用或小程序
   - 针对触屏优化界面
   - 添加移动端特有功能

3. **智能推荐**
   - 基于用户行为的景点推荐
   - 个性化内容展示
   - 智能搜索优化

### 第三阶段（系统升级）

1. **高可用架构**
   - 负载均衡设计
   - 服务集群部署
   - 数据备份与恢复方案

2. **第三方平台集成**
   - 第三方登录支持（微信、QQ等）
   - 社交媒体分享功能
   - 外部旅游平台对接

3. **高级数据分析**
   - 用户行为预测
   - 智能营销决策支持
   - 客流量预测与调控

## 开发环境

- **Node.js**：v18 及以上
- **数据库**: PostgreSQL 15 及以上 或 MySQL 8 及以上
- **包管理**：pnpm（推荐）或 npm
- **工具**：
  - VS Code（推荐，安装 ESLint 和 Prettier 插件）
  - pgAdmin（数据库管理）
  - Apifox（API 测试）

## 快速开始

1. 克隆仓库：

    ```bash
    git clone https://github.com/TomyJan/MoeTrip.git
    cd MoeTrip
    ```
2. 安装依赖：

    ```bash
    cd backend && pnpm install
    cd ../frontend && pnpm install
    ```

3. 配置环境：

    复制 `backend/.env.example 到 backend/.env`，设置数据库连接

    运行 `backend/scripts/init_db_postgres.sql` 或 `backend/scripts/init_db_mysql.sql` 初始化数据库

4. 启动服务：

    ```bash
    # 后端
    cd backend && pnpm start
    # 前端
    cd frontend && pnpm dev
    ```

	访问：打开浏览器，进入 [http://localhost:5200](http://localhost:5200)

## 文档

整体设计：[docs/system_design.md](docs/system_design.md)

目录结构：[docs/directory_structure.md](docs/directory_structure.md)

API 文档：[docs/api/api_spec.md](docs/api/api_spec.md)

## 许可证

本项目采用 MPL 2.0 许可证，详情请参见 [LICENSE](LICENSE)

- [Vue.js](https://vuejs.org/)
- [Vuetify](https://vuetifyjs.com/)
- [ECharts](https://echarts.apache.org/)
- [Express](https://expressjs.com/)
- [Sequelize](https://sequelize.org/)
- [TypeScript](https://www.typescriptlang.org/)
- [Node.js](https://nodejs.org/)
- [PostgreSQL](https://www.postgresql.org/)
- [Jest](https://jestjs.io/)
